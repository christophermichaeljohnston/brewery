{% extends "base/index.html" %}
{% block content %}
<h1>Fermenter</h1>
<table class="table">
  <thead>
    <tr>
      <th class="col-xs-1">id</th>
      <th class="col-xs-1">sn</th>
      <th class="col-xs-1">tag</th>
      <th class="col-xs-1">mode</th>
      <th class="col-xs-1">setpoint</th>
      <th class="col-xs-1">hysteresis</th>
      <th class="col-xs-1">pumprun</th>
      <th class="col-xs-1">pumpdelay</th>
      <th class="col-xs-1">action</th>
      <th class="col-xs-1">temp</th>
    </tr>
  </thead>
{% if fermenter %}
  <tbody>
    <tr>
      <td>{{ fermenter.id }}</td>
      <td>{{ fermenter.sn }}</td>
      <td>{{ fermenter.tag }}</td>
      <td>{{ fermenter.mode }}</td>
      <td>{{ fermenter.setpoint }}</td>
      <td>{{ fermenter.hysteresis }}</td>
      <td>{{ fermenter.pumprun }}</td>
      <td>{{ fermenter.pumpdelay }}</td>
      <td><a href="{% url 'fermenter:edit' fermenter.id %}">Edit</a>|<a href="{% url 'fermenter:temperature' fermenter.id %}">Temperature</a>|<a href="{% url 'fermenter:chart' fermenter.id %}">Chart</a></td>
      <td>{{ fermenter.temperature_set.all.last.temperature }} F at {{ fermenter.temperature_set.all.last.datetime }}</td>
    </tr>
  
{% endif %}
  </tbody>
</table>

<div id="chart"></div>


<script>
$(document).ready(function() {
$.getJSON('{% url 'fermenter:chart' fermenter.id %}', function(data) {
console.log(data);
$(function () { 
Highcharts.setOptions({
  global: {
    useUTC: true,
  }
});
    $('#chart').highcharts({
        chart: {
            type: 'line'
        },
        title: {
            text: 'Fermenter Temperature'
        },
xAxis: {
type: 'datetime'
},
yAxis: {
title: {
text: 'Temperature'
}
},
        series: [{
            data: data['data']
        }]
    });
});
});
});
</script>

<script>
$(document).ready(function() {
$(function () { 
Highcharts.setOptions({
  global: {
    useUTC: true,
  }
});
    $('#chart').highcharts({
        chart: {
            type: 'line'
        },
        title: {
            text: 'foo'
        },
xAxis: {
type: 'datetime'
},
yAxis: {
title: {
text: 'Temperature'
}
},
        series: [{
            data: {{ data|safe }}
        }]
    });
});
});
</script>



{% endblock content %}
